RadioDiff: An Effective Generative Diffusion Model for Sampling-Free Dynamic Radio Map Construction
Publisher: IEEE

Xiucheng Wang; Keda Tao; Nan Cheng; Zhisheng Yin; Zan Li; Yuan Zhang

Radio map (RM) is a promising technology that can obtain pathloss based on only location, which is significant for 6G network applications to reduce the communication costs for pathloss estimation. However, the construction of RM in traditional is either computationally intensive or depends on costly sampling-based pathloss measurements. Although the neural network (NN)-based method can efficiently construct the RM without sampling, its performance is still suboptimal. This is primarily due to the misalignment between the generative characteristics of the RM construction problem and the discrimination modeling exploited by existing NN-based methods. Thus, to enhance RM construction performance, in this paper, the sampling-free RM construction is modeled as a conditional generative problem, where a denoised diffusion-based method, named RadioDiff, is proposed to achieve high-quality RM construction. In addition, to enhance the diffusion model’s capability of extracting features from dynamic environments, an attention U-Net with an adaptive fast Fourier transform module is employed as the backbone network to improve the dynamic environmental features extracting capability. Meanwhile, the decoupled diffusion model is utilized to further enhance the construction performance of RMs. Moreover, a comprehensive theoretical analysis of why the RM construction is a generative problem is provided for the first time, from both perspectives of data features and NN training methods. Experimental results show that the proposed RadioDiff achieves state-of-the-art performance in all three metrics of accuracy, structural similarity, and peak signal-to-noise ratio. The code is available at https://github.com/UNIC-Lab/RadioDiff.
Published in: IEEE Transactions on Cognitive Communications and Networking ( Volume: 11, Issue: 2, April 2025)
Page(s): 738 - 750
Date of Publication: 22 November 2024 
ISSN Information:
DOI: 10.1109/TCCN.2024.3504489
Publisher: IEEE
Funding Agency:
SECTION I.Introduction
In wireless networks, pathloss quantifies the attenuation of signal strength between a pair of sender and receiver caused by free-space propagation loss and interactions of radio waves with obstacles [1], [2], [3], which is critical to be measured for wireless resource management [4], [5], [6]. Traditionally, the pathloss measurement usually depends on pilot transmission and signal processing [7]. However, the dramatic increase of network nodes and antennas has led to the challenge of estimating high-dimensional channels [8], resulting in significant costs in training and feedback overhead, as well as signal processing complexity [9]. This issue further deteriorates in high-mobility scenarios with short channel coherence times for low-latency applications [10], [11]. Meanwhile, the upcoming 6G networks will introduce a large variety of node types, including passive equipment such as intelligent reflective surfaces (IRS) [12], which cannot actively transmit pilots or engage in digital signal processing to measure the pathloss.

The emergence of these new scenarios makes it necessary to efficiently obtain pathloss using easy-to-be-obtained information without pilot transmission and signal processing. Consequently, radio map (RM) technology has been developed, by which the pathloss can be acquired just through location information [13]. Traditional RM construction methods can be categorized into two types: (1) sampling-based approaches that rely on sampling position measurements (SPM) within the RM region, which are then used for interpolation or solving specific least squares problems to construct the RM [14], [15], [16], and (2) sampling-free methods which are achieved through environmental 3D modeling and electromagnetic ray tracing (ERT) [17]. However, both methods face their own inherent challenges. The sampling-based methods require SPM of the RM construction area, with too few or inaccurate measurements leading to poor construction quality, while a large number of high-precision measurements significantly increase RM construction costs. Moreover, such methods cannot be used to construct RM in never-to-reach regions, limiting its applicability, such as UAV trajectory plan. On the other hand, the ERT-based method, while avoiding measurement costs, is burdened with high computational complexity and struggles to achieve RM construction within acceptable timeframes. Furthermore, both methods are restricted to the construction of static RM (SRM) due to their construction principles, which do not account for the real-time transformation of elements affecting pathloss. Consequently, changes in pathloss resulting from factors such as vehicle motion or alterations in reflection diameters are not reflected in the RM. The sampling-based method requires multiple sampling points to be measured across a wide area, making it impractical to arrange sufficient measurement equipment for simultaneous pathloss collection. Additionally, the time-series measurement of different sampling points/sets leads to data collection at different times, rendering real-time RM construction unattainable [14], [15]. Similarly, the ERT-based method, which fundamentally relies on ray tracing of a static 3D scene, typically involves calculations that take several minutes or even longer, rendering it unsuitable for RM construction with dynamic environmental features [17].

To address these challenges, numerous researchers have exploited neural networks (NNs) with rapid inference capabilities to facilitate RM construction. The most notable pioneering work is the RadioUNet that leverages the U-Net, which is a classical architecture for image-to-image tasks, for RM construction [18]. Although some NN-based methods have demonstrated better performance than traditional SPM-based methods in RM construction, their performance, especially in details construction for the dynamic RM (DRM) with multiple dynamic obstacles,1 is poor. Therefore, the majority of NN-based methods focus on RM construction in static environments, neglecting the exploration of RM construction in dynamic environments [18], [19], [20], [21]. This is primarily attributed to two challenges: the heterogeneous propagation characteristics of electromagnetic waves and the complexity of RM texture features. The RM construction in static environments typically only concentrates on the influence of buildings on electromagnetic ray propagation, since it can be assumed that all objects affect electromagnetic rays in the same manner. In the context of DRM construction, the impact of moving objects, such as vehicles, on electromagnetic rays must be taken into account. As shown in Fig. 1, the influence of vehicles on electromagnetic ray propagation markedly differs from that of buildings. Different from static obstacles with large shapes and high heights, which can completely block direct electromagnetic rays from the base station (BS) to their surfaces, dynamic obstacles such as vehicles, due to their low height and small size, cannot entirely obstruct the electromagnetic signal. This partial blockage results in a reduction of the pathloss rather than a complete obstruction, thereby increasing the complexity of RM construction and the texture features than SRM. Moreover, existing NN-based methods mainly train the NN through supervised learning in a discriminative style, whose objective is to minimize the mean square error (MSE) between the predicted RM and the ground truth. However, it has been demonstrated in [22], [23] that while the widely used MSE metric in discriminative training methods enhances the convergence speed of NN training, it degrades the NN’s ability to capture the elaborately detailed features of the data, resulting in blurred edges. As shown in Fig. 1, RM (especially DRM) typically contains more detailed texture features. Neural networks trained with MSE-based supervised learning methods struggle to extract these detailed features.

Fig. 1. - Illustration of the RM, where the yellow elements represent the heatmap of pathloss; the brighter the yellow, the higher the pathloss. The red elements denote vehicles, and the blue elements are static buildings. Since, static buildings can completely block electromagnetic signals from entering their interiors, resulting in an internal pathloss of zero, to intuitively represent the impact of static buildings on the RM, we have colored them blue.

Fig. 1.
Illustration of the RM, where the yellow elements represent the heatmap of pathloss; the brighter the yellow, the higher the pathloss. The red elements denote vehicles, and the blue elements are static buildings. Since, static buildings can completely block electromagnetic signals from entering their interiors, resulting in an internal pathloss of zero, to intuitively represent the impact of static buildings on the RM, we have colored them blue.

Show All

The fundamental reason for the above challenges is the misalignment between the generative problem attributes of the RM construction and the discriminant methodology. RM construction shows the characteristics of generative problems in both data features and NN training methods, while the existing sample-free NN-based methods use discriminant methods to construct RM, which inevitably limits the construction performance of RM. Specifically, in terms of data features, neither the value nor location of the elements of the pathloss to be predicted exist in the input environmental data, thus NN is required to generate pathloss from the raw data. Moreover, since the elements in the RM are not discrete values, it is almost impossible to construct the RM by dividing a finite number of hyperplanes to classify the elements in the environmental data as a discriminative problem [24], [25]. Therefore, the use of discriminant training methods to generate multiple hyperplanes in the latent space using NN to predict pathloss will inevitably lead to poor performance. Furthermore, the self-supervised training method that uses data which is partially masked as input to train NN to predict masked information is mainly used in the training of generative models [26]. In the context of RM construction, the data representing environmental information, can be regarded as the RM whose pathloss is masked, and the NN-based RM construction methods use these masked RM data to recover the pathloss, which is a self-supervision training method. Based on the above analysis, RM construction is a generative problem, so from the perspective of the alignment of the problem and the methodology, a generative method should be used to effectively construct the RM. Moreover, the generative training methods enable NN training both using generative loss and MSE loss, where the NN’s capacity to extract intricate texture features of RM can be enhanced. Generative adversarial networks (GANs) have been extensively studied in RM reconstruction; however, their potential is often hindered by extreme instability during training. In contrast, the diffusion model offers a novel solution to the RM reconstruction problem. Geographic maps and RM contain abundant high-frequency sharp edges. Directly feeding these into NN-based models can result in erratic predictions, noise, and artifacts. Diffusion models, however, demonstrate superior capability in capturing this edge information and predicting conditions. Therefore, to achieve high-performance RM construction by taking advantage of the generative NN training method, in this paper, the RM construction problem is modeled as a conditional generative problem, where a generative diffusion-based method, named RadioDiff, is proposed to construct the RM effectively.2 The main contributions of this paper are as follows.

For the first time, the sampling-free RM construction problem is modeled as a conditional generative problem, where the location of the BS, and the environment features are used as prompts for conditional generation. In addition, theoretically, a detailed analysis of why the RM construction is a generative problem from the perspective of data features and NN training methods is provided for the first time.

To the best of our knowledge, the diffusion-based generative model is first used for effective RM construction. Moreover, to enhance the performance and the inferencing efficiency of the diffusion model, a decoupled diffusion model is used in this paper.

To enhance the diffusion model’s capability to extract dynamic environmental features, the prompts of the static and dynamic environmental features are represented by two matrices, respectively. Additionally, the adaptive fast Fourier transform module is employed to enhance the diffusion model’s ability to extract high-frequency information resulting from dynamic environmental features in the data.

The experimental results demonstrate that the proposed RadioDiff achieves state-of-the-art (SOTA) RM construction performance in all three metrics of accuracy, structural similarity, and peak signal-to-noise ratio.

The remainder of this paper is organized as follows. We first overview the related works of RM construction and give preliminaries of the diffusion model in Section II, then the RM construction problem is formulated and analyzed in Section III. In Section IV the details of the proposed RadioDiff are introduced, while in Section V the experimental results are given. Section VI concludes our work. The notations are shown in Table I.

TABLE I Notation Table
Table I- Notation Table

SECTION II.Preliminaries and Related Work
A. Radio Map Construction
The construction of RM can be categorized into two primary types: sampling-based and sampling-free. The sampling-based methods primarily utilize SPM to obtain pathloss in specific areas for interpolation. Although these methods are independent of knowing environmental details and BS location, they require pathloss measurement in the targeted regions for RM construction. Among these methods, the K-nearest neighbors technique obtains RM data for other locations by weighted averaging the pathloss values of the K nearest sparse measurement points [14]. Additionally, local multinomial regression is commonly employed in sampling-based RM construction. This approach determines the pathloss at a current point by solving a least squares problem that involves the pathloss values of nearby sparse measurement points [15]. To further enhance the quality of sampling-based RM construction, Kriging interpolation has been proposed. This method treats RM construction as a stochastic process modeling and prediction problem based on a covariance function, thereby improving the accuracy of RM construction [16].

The aforementioned sampling-based methods face two significant challenges: dependence on SPM and low construction accuracy [18], [19]. Consequently, sampling-free RM construction methods, based on NN, have attracted the attention of researchers. These methods typically require knowledge of the environmental features, such as obstacle locations, heights, and the positions of BS, to construct RMs. A representative example is the RadioUNet, which is derived from the classic U-Net framework used in image-to-image tasks [18]. This approach leverages the U-Net framework, training NN using the MSE between the generated RM and the ground truth, yielding impressive results [18]. Inspired by RadioUNet and the success of the Vision Transformer (ViT) led to the development of Radionet, based on the transformer architecture for RM construction [19]. Additionally, more complex NN architectures, such as graph neural networks (GNN) [20], with stronger feature extraction capabilities, have been employed in RM construction. However, these approaches generally treat sampling-free RM construction as a discriminative supervised learning task. Although RME-GAN attempts to introduce generative adversarial networks (GAN) methods into RM construction, it is not sampling-free, as it relies on SPM within the construction area [21]. Different from existing NN-based RM construction methods, in this paper, the sampling-free RM construction is modeled as a conditional generative problem, and a diffusion-based method is proposed which significantly improves the RM construction performance.

B. Diffusion Model
The diffusion model is a category of generative models based on Markov chains, that progressively restore data through a learned denoising process. This model has emerged as a strong competitor to the GAN in various generative tasks, such as computer vision [27], and natural language processing [22]. Moreover, diffusion models exhibit significant potential in perception tasks, including image segmentation, object detection, and model-based reinforcement learning (RL) [28]. For example, in [29], the authors effectively utilized diffusion model-based soft actor-critic algorithms for optimal contract design. Besides, the authors in [30] innovatively leveraged diffusion model-based deep deterministic policy gradient algorithms for optimal Stackelberg game solutions. In the diffusion model, there are two procedures which are the forward diffusion procedure where the raw data is diffused into noise, and the reversed denoise procedure where an NN is used to remove the noise adding to the raw data, thus generating raw data from noise.

1) Forward Diffusion Procedure:
From a probabilistic modeling standpoint, the essence of generative models lies in training them to produce data x^∼pθ(x^) that mirror the distribution of the training data x∼pt(x) . The denoising diffusion probability model (DDPM) employs two Markov chains: a forward chain that converts data into noise, and a backward chain that reverts the noise to data. In a formal context, given the data x0 , the progression of a forward Markov chain is realized by generating a series of stochastic variables x1,x2,…,xT , which evolve following the transition kernel q(xt|xt−1) . By employing the chain rule of probability in conjunction with the Markovian property, it is possible to deconstruct the joint probability distribution of x1,x2,…,xT given x0 , expressed as q(x1,…,xT|x0) , into an appropriate factorial form.
q(x1,…,xT∣x0)=∏t=1Tq(xt∣xt−1).(1)
View SourceRight-click on figure for MathML and additional features.
Thus, a forward noising process which produces latent xt through x0 by adding Gaussian noise at time t ∈ {0, 1, …, T} can be defined as follows.
q(xt∣xt−1)=N(1−βt−−−−−√xt−1,βtI),(2)
View SourceRight-click on figure for MathML and additional features.
where T and βt∈(0,1) are the total number of diffusion iterations and hyper-parameter of the variance scaling factor, respectively. By setting αt=1−βt and α¯t=∏ts=0αs , the distribution of xt condition on the x0 can be obtained as follow.
q(xt∣x0)=xt=N(α¯t−−√x0,(1−α¯t)I),α¯t−−√x0+1−α¯t−−−−−√ϵ,(3)(4)
View SourceRight-click on figure for MathML and additional features.
where N(⋅,⋅) is Gaussian distribution, I is identity matrix, and ϵ∼N(0,I) .

In addition, Eq. (4) describes how the noisy data xt is generated by combining the original input x0 with a Gaussian noise term ϵ . The term α¯t−−√x0 represents the scaled contribution of the original data, while 1−α¯t−−−−−√ϵ represents the amount of noise added at each step. As t increases, the influence of the noise term grows, resulting in progressively noisier data.

2) Reversed Denoise Procedure:
For the data generation, DDPM initially creates unstructured noise vectors from the prior distribution, subsequently removing the noise through a learnable Markov chain operated in reverse temporal order. To achieve this, the reverse process can be formulated as follows.
pθ(xt−1|xt)=N(μθ(xt,t),βtI)(5)
View SourceRight-click on figure for MathML and additional features.
where βt is a hyper-parameter, θ is the parameter of NN μθ . Applying a trained NN μθ , we can iteratively denoise xt from t=T to t= 1 as follows [28].
xt−1=1αt−−√(xt−1−αt1−α¯t−−−−−√μθ(xt,t))+βtI.(6)
View SourceRight-click on figure for MathML and additional features.
Remarkably, the second term in (6) serves the purpose of obtaining the same distribution of xt−1 obtained through denoising, particularly in terms of variance, as that is derived through forward diffusion. If the second term of (6) is removed, the xt−1 obtained by denoising is just equal to the mean of which obtained via forward diffusion procedure. Strictly, the scaling factor in the second term of (6) should be 1−α¯t−11−α¯tβt to ensure distribution consistency. However, as shown in [31], setting the scaling factor to βt achieves the same performance as setting it to 1−α¯t−11−α¯tβt , while also reducing computational complexity. Therefore, the scaling factor in the second term of (6) is βt both for efficiency and effectiveness.

SECTION III.Problem Formulation of RM Construction
We consider the scenario where the RM needs to be constructed within an area as a grid of size N×N , since the grid is small enough, the pathloss in a grid is a constant, where the RM can be represented by a matrix P . Within this region, there is a BS with a single antenna and multiple static and dynamic obstacles. The location of BS can be represented by a tuple R as ⟨h,dx,dy⟩ , where h,dx and dy is the height and coordinates of the BS. The static obstacles have varying sizes and shapes but are composed of the same surface material, thus reflecting and diffracting electromagnetic waves in the same way, and similar to [18], [19], [21] the pathloss is zero within their interiors. The static obstacle information is represented by the matrix Hs∈RN×N , where a value of hsi,j=0,∀hsi,j∈Hs indicates the absence of the static obstacle at the position of i-th row and j-th column. Moreover, dynamic obstacles, such as vehicles, impact electromagnetic wave propagation through shielding, reflecting, and diffracting effects, similar to fixed obstacles, however, due to their small size and short height, dynamic obstacles cannot completely block the propagation of electromagnetic rays in its direction. The information of dynamic obstacles is represented by the matrix Hd∈RN×N , where the hdi,j=0,∀hdi,j∈Hd indicates the absence of dynamic obstacle at the position of i-th row and j-th column.

The objective of this paper is to train an NN μθ(⋅) with parameters θ to predict the pathloss matrix P^∈RN×N based on the environmental features and location of the BS to minimize the difference between the predicted P^ and the ground truth P . The difference can be measured by the criterion function L(P^,P) . Therefore, the problem of RM construction can be formulated as


Problem 1:
minθ  L(P^,P),s.t.  P^=μθ(Hs,Hd,R),(7)(7a)
View SourceRight-click on figure for MathML and additional features.
The Problem 1 is a generative problem rather than a discriminative problem, which can be analyzed from both the data features and training method perspective. First, from the perspective of data features, the pathloss needs to be predicted from empty elements of the input data, as they do not exist in the environmental matrixes Hd and Hs , which should be generated by the NN μθ(⋅) . Moreover, since the pathloss to be predicted is not a discrete value, it is almost impossible to construct the RM by dividing the finite hyperplane to classify the nodes. However, from the perspective of statistical learning, the fundamental of discriminative tasks, especially supervised learning, is to let NN learn from the latent space to the partitioning of hyperplanes to achieve data classification [24]. Thus, the discriminative method inevitably limits the performance of RM construction. Second, from the perspective of training methods, the self-supervised training method is mainly used by the generative model, where some elements of the raw data are masked and an NN is trained to recover the masked data through unmasked data in self-supervised learning [26]. In the RM construction, the environmental information ⟨Hs,Hd⟩ can be regarded as P whose pathloss elements are masked, and the NN needs to predict the masked pathloss elements based on unmasked data that are ⟨Hs,Hd⟩ . Therefore, the NN used for RM construction is trained in a self-supervised learning style. In addition, since the location of the BS R affects the distribution of pathloss, the BS can be regarded as a condition in self-supervision training, which means that the construction of RM is a condition generative problem.

SECTION IV.Diffusion-Based RM Construction
As analyzed in Section III the RM construction is a generative problem, thus the SOTA generative diffusion model is used as a backbone to construct the RM effectively.

A. Initial Processing
To improve the convergence speed, the pathloss matrix P is encoded into a grayscale matrix through a process involving logarithmic scaling, normalization, and subsequent quantization [18]. Additionally, R is also represented as a grayscale matrix, with a pixel value of 1 denoting the location of the AP, while other pixels are set to 0. Subsequently, all the environment information is encoded into a three-channel tensor as a prompt tensor C=[Hs,Hd,R] . To further enhance the training efficiency of the denoise diffusion model, similar to [28], we initially train a variational autoencoder (VAE) to encode the raw data into the latent space for training and testing [32]. The encoder E module of the VAE encodes P as a latent vector z0 , where the noise is added to the z0 according to (3) for training. After the noise is removed by the NN, the decoder module D of the VAE is utilized to recover the RM from the diffusion prediction vector z^0 . Through the use of the VAE, the denoise diffusion model only needs to remove the noise vector added to z instead of the noise matrix originally added to P , thereby reducing the output space dimension of the diffusion model to enhance training efficiency. Thus, in the following of this paper, we use the latent vector z instead of x to denote the image to be generated. It is essential to highlight that the training of the VAE operates independently of the subsequent training of the denoise diffusion model, where the VAE only utilizes P for training the encoder E and decoder D trained in an autoencoder style. Then the VAE’s parameters remain static and do not change in the subsequent training procedure of the diffusion model.

B. RadioDiff via Decoupled Diffusion Model
Although DDPM and latent diffusion models (LDM) have shown considerable potential across various fields, their extensive inference times and prolonged training durations motivate the use of a decoupled diffusion model (DDM) [33] for further enhancement. In DDM, the procedure of diffusing z0 to zt is modeled as a two-stage continuous Markov process. First, z0 gradually diffuses into a 0 vector, then the noise ϵ is added to this 0 vector to form zt . The distribution of zt can be formulated as follows.
q(zt∣z0)=N(γtz0,δ2tI),(8)
View SourceRight-click on figure for MathML and additional features.
where γt and δt are hyper-parameters, and δt is designed to increase gradually over time while γt decreases. Compared to traditional diffusion models where the diffusion process directly adds noise to the original input x0 or z0 , the decoupled diffusion model used in RadioDiff splits this process into two distinct stages. In DDM, z0 first diffuses into a 0 vector, which effectively decouples the contribution of the original input from the added noise. This allows for a more controlled diffusion process, as the noise ϵ is only introduced after z0 has been reduced to a 0 vector. As a result, DDM reduces the variance in early diffusion steps and improves stability during both training and inference. Furthermore, this decoupled structure helps mitigate the prolonged inference time seen in traditional diffusion models, enabling more efficient generation in RadioDiff. Thus, according to [34], (8) can also be expressed as the following differential equation.
dzt=ft=g2t=ftzt dt+gt dϵt,dlogγt dt,dδ2t dt−2ftδ2t,(9)(10)(11)
View SourceRight-click on figure for MathML and additional features.
Based on the above equations, inverting zt to z0 can be derived as follows.
dzt=[ftzt−g2t∇xlogq(zt)]dt+gtdϵ¯¯¯t,(12)
View SourceRight-click on figure for MathML and additional features.
where ϵ¯¯¯t is the Gaussian random variable in the reversed diffusion, playing a similar role as the second term of (6). By applying the decoupled diffusion strategy, the forward diffusion process can be redefined as follows.
zt=z0+∫t0ftdt+∫t0dϵt,z0+∫t0ftdt=0,(13)(14)
View SourceRight-click on figure for MathML and additional features.
where z0+∫t0ftdt describes the data attenuation process and ∫t0dϵt denotes the noise addition process. The function ft is a differentiable function of t, and ϵt is the standard Wiener process. Corresponding to equation (8), the conditional distribution can be simplified as follows.
q(zt|z0)=N(z0+∫t0ftdt,tI).(15)
View SourceRight-click on figure for MathML and additional features.
By using the conditional probability formula the reverse sampling process, zt−Δt can be obtained as follows.
q(zt−Δt∣zt,z0)=N(zt+∫t−Δttft dt−Δtt√ϵ,Δt(t−Δt)tI).(16)
View SourceRight-click on figure for MathML and additional features.
According to (16), to reverse the noisy zt into z0 , which corresponds to the feature map of RM P in this paper, the NN only needs to predict two terms: ∫t−Δttft dt and ϵ , since zt is a known vector to denoise. As shown in Fig. 3, two U-Net decoder networks are employed to predict ∫t−Δttft dt and ϵ , respectively. according to (13), the label for ϵ is straightforward to obtain since the noise is added manually. However, the label for ∫t−Δttft dt must be obtained by solving the differential equation (14). In the training procedure, the ground truth is obtained by solving z0+∫10ft dt=0 . For a simple example where ft is equal to a constant c , the ft can be easily determined as ft=c=−z0 . For another scenario where the value ft is in linear dependence with t that is ft=at+b , solving the two parameters a and b using one equation is infeasible. To address this, we should sample one parameter from N(0,I) and substitute it into z0+∫10ft dt=0 to solve the other parameter. In this way, we concatenate a and b to obtain the ground truth. The ground truths for other functions can be determined similarly. Since different ft calculation methods have different effects on the data quality generated by diffusion, the coefficients of the equations for calculating ground truth of ft can also be considered as hyper-parameters.

Fig. 2. - The diffusion procedure of RM, where in diffusion procedure the RM is diffused into noise, and in the denoising procedure the RM is revealed from the noise and prompt.

Fig. 2.
The diffusion procedure of RM, where in diffusion procedure the RM is diffused into noise, and in the denoising procedure the RM is revealed from the noise and prompt.

Show All

Fig. 3. - The illustration of the proposed RadioDiff framework. The VAE is employed to encode the RM into a latent vector, thereby reducing the dimension of the input/output space for the denoise diffusion model. The framework incorporates a U-Net architecture, consisting of an encoder and decoder, to facilitate the denoising process. The prompt is represented as a grayscale diagram with three channels, each channel depicting the features of buildings, vehicles, and AP. After encoding the prompt, it is concatenated into the U-Net network, enabling the model to generate RMs under environmental conditions.

Fig. 3.
The illustration of the proposed RadioDiff framework. The VAE is employed to encode the RM into a latent vector, thereby reducing the dimension of the input/output space for the denoise diffusion model. The framework incorporates a U-Net architecture, consisting of an encoder and decoder, to facilitate the denoising process. The prompt is represented as a grayscale diagram with three channels, each channel depicting the features of buildings, vehicles, and AP. After encoding the prompt, it is concatenated into the U-Net network, enabling the model to generate RMs under environmental conditions.

Show All

It should be emphasized that the above diffusion and denoising processes are based on constraint-free RM construction. However, according to Problem 1, we need to achieve conditional RM construction based on environmental and BS location information, ensuring that the generated RM is correlated with these features. To enable the NN to generate the required RM based on the prompt C , we employ a conditional generative model using an attention-based architecture. This approach leverages the attention mechanism, allowing the output of the NN to correlate with the given attention key-value vectors K and V . Since the attention architecture cannot directly handle two-dimensional data, an extractor NN ν(⋅) projects the prompt C into an embedding space. This embedding is then projected to the intermediate layers of the U-Net through a cross-attention layer, implementing the attention mechanism Attention(Q,K,V)=softmax(QKTd√)⋅V as follows.
Q=K=V=WQ⋅ϕ(zt),WK⋅ν(C),WV⋅ν(C),(17)(18)(19)
View SourceRight-click on figure for MathML and additional features.
where ϕ(zt) is the flattened operator applied on the output from the U-Net, which executes the function θ and applies the transformation WV . Additionally, WQ and WK represent trainable projection matrices [35]. The training loss function can be represented as follows.
L=Ez,c,t,ϵ[∥ϵ−ϵθ∥2+∥f−fθ∥22],ϵθ,fθ=μθ(zt;C,t).(20)(21)
View SourceRight-click on figure for MathML and additional features.

C. Adaptive FFT Filter for DRM Enhancement
As shown in Fig. 1, RM exhibits numerous edge texture features, especially in DRM, which generate substantial high-frequency information in the frequency domain [36]. Although conventional convolutional layers within the denoising U-Net effectively extract features, they struggle to precisely capture high-frequency components. As a result, neural networks (NNs) based solely on traditional convolutional layers often produce overly smooth RM outputs, leading to blurred representations and suboptimal performance in dynamic environments.

To address this issue, as depicted in Fig. 3, an adaptive Fast Fourier Transform (FFT) filter (AFT) module is introduced, specifically to enhance the model’s capacity for extracting high-frequency features. The AFT module operates by transforming the 2D feature maps z , generated by the encoder with spatial dimensions H×W and channel count C, from the spatial domain to the frequency domain via the FFT operation, represented as zc=F(z) , where F denotes the FFT. To improve the model’s ability to focus on relevant frequency components, AFT incorporates a learnable weight matrix w∈CH×W×C . This matrix is applied to the frequency-domain features zc via the Hadamard product, w⊙zc . The learnable weight matrix dynamically adjusts the model’s response to different frequency distributions in the target data, emphasizing important frequencies while attenuating irrelevant ones. This adaptive spectral filtering allows the model to perform global frequency adjustments based on data-driven relevance, ensuring that high-frequency features are enhanced while less critical frequencies are suppressed.

Following this adaptive filtering process, the modified frequency-domain features are transformed back into the spatial domain using the Inverse Fast Fourier Transform (IFFT). To preserve key information and mitigate potential losses during filtering, a residual connection is introduced between the original feature map z and the output feature map. The complete operation of the AFT module can be described as follows:
z=zc=z+F−1(w⊙zc),F(z).(22)(23)
View SourceRight-click on figure for MathML and additional features.

SECTION V.Experiments
A. Datasets
In this study, we evaluate the performance of the proposed method using the RadioMapSeer dataset provided by the pathloss RM construction challenge [37].

The dataset consists of 700 maps, each with unique geographic information (e.g., building data), with each map containing 80 transmitter locations and their corresponding ground truth data. Each map contains between 50 and 150 buildings. We selected 500 maps for the training dataset and the remaining 200 maps for the test dataset. There is no overlapping terrain information between the training and test datasets.

The city maps include data from cities such as Ankara, Berlin, Glasgow, Ljubljana, London, and Tel Aviv, sourced from OpenStreetMap. In the dataset, both transmitter and receiver heights are set at 1.5 meters, while building heights are set at 25 meters. Each map is converted into a 256×256 pixel morphological 2D image with binary pixel values (0/1), where each pixel represents one square meter: ‘1’ for areas inside buildings and ‘0’ for areas outside.

Transmitter positions are stored in a two-dimensional numerical format and depicted in morphological images, with the transmitter’s pixel set to ‘1’ and all others to ‘0’. The transmitter power is set to 23 dBm, and the carrier frequency is 5.9 GHz. To obtain a sufficiently accurate RM as ground truth for training, the ground truth RM in the dataset is constructed using Maxwell’s equations, where the pathloss is calculated by the reflection and diffraction of electromagnetic rays. The RMs that only consider the impact of the static buildings on the electromagnetic rays are used as the ground truth of SRM. Additionally, the RMs in the dataset that consider the impact both of the static buildings and the vehicles, which are randomly generated along the roads, are used as the ground truth of the DRM, as shown in Fig. 1.

B. Metrics
To comprehensively evaluate the quality of RM construction, we begin by adopting the parameters commonly used in previous studies [18], namely NMSE and RMSE. Additionally, we observe that the accurate generation of structural information and details is a key objective in RM reconstruction tasks, whereas the MSE index focuses on overall error and does not directly address these specific requirements. Therefore, we propose introducing structural similarity index measurement (SSIM) and peak signal-to-noise ratio (PSNR) as additional metrics in this paper. SSIM evaluates the preservation of structural information to emphasize the accuracy of structural detail reconstruction, while PSNR measures the signal-to-noise ratio to assess the fidelity of RM construction, particularly with respect to edge signal reconstruction.

1) MSE:
MSE is calculated by averaging the squared differences between the pixel intensities of the original and final images as follows.
MSE=1NMΣM−1m=0∑n=0N−1e(m,n)2,(24)
View SourceRight-click on figure for MathML and additional features.
where e(m, n) is the error difference between the ground truth and the predicted RM, and M, N is the length and width of the image, respectively. The normalized MSE (NMSE) is a scaled version of MSE employed to assess the predictive accuracy of the RM construction, where rooted MSE (RMSE) is the rooted MSE, which are defined as follows.
NMSE=RMSE=ΣMm=1ΣNn=1(Ib(m,n)−I(m,n))2ΣMm=1∑Nn=1I2(m,n),MSE−−−−−√(25)(26)
View SourceRight-click on figure for MathML and additional features.

2) SSIM:
SSIM is a quality assessment metric inspired by the human visual system. Since SSIM focuses on measuring texture differences, and there are lots of high-frequency details in RM, SSIM is suitable for evaluating the quality of the generated results. We also believe that greater attention should be given to the brightness of the signal radiation, the contrast between the signal radiation and the surrounding area, and the accuracy of geographic map in RM reconstruction. This aligns with the SSIM metric, which evaluates three key components: brightness, contrast, and structural information, which can be calculated as follows.
l(x,y)=c(x,y)=s(x,y)=2μX(x,y)μY(x,y)+C1μ2X(x,y)+μ2Y(x,y)+C12σX(x,y)σY(x,y)+C2σ2X(x,y)+σ2Y(x,y)+C2σXY(x,y)+C3σX(x,y)σY(x,y)+C3(27)(28)(29)
View SourceRight-click on figure for MathML and additional features.
where x, y correspond to two different input images and μx,σ2x,σxy denote the mean and variance of x and the covariance of x and y respectively. In addition, C1 , C2 , and C3 are constants which are defined as follows.
C1=(K1L)2,C2=(K2L)2,C3=C22,
View SourceRight-click on figure for MathML and additional features.
where L represents the dynamic range of the data. Based on these parameters, the structural similarity can be computed as described as follows.
SSIM(x,y)=(2μxμy+c1)(σxy+c2)(μ2x+μ2y+c1)(σ2x+σ2y+c2)(30)
View SourceRight-click on figure for MathML and additional features.

3) PSNR:
The PSNR is defined as the ratio between the maximum possible power of a signal and the power of interfering noise that affects the fidelity of its representation. PSNR is typically expressed in decibels (dB) and provides an approximate measure of the perceived quality of reconstruction. In image evaluation, a higher PSNR generally indicates better image quality. For RMs, an accurate edge signal is crucial; therefore, PSNR is used not only to assess overall image quality but also to determine the quality of edge detail in the generated RMs. PSNR can be calculated as follows.
PSNR=10log10(r2MSE)(31)
View SourceRight-click on figure for MathML and additional features.
where r is the maximal variation in the input image data.

C. Implementation
We implemented our RadioDiff framework using the PyTorch framework. The training process is divided into two phases, both utilizing an AdamW optimizer with a decaying learning rate, starting from 5×10−5 and reducing to 5×10−6 . In the initial phase, the autoencoder is trained using RM images from the entire dataset’s training set as ground truth. This phase, which trains the VAE with z-channels set to 3 and embedding dimension of 128, takes approximately 120 hours on 4× NVIDIA A100 SXM GPUs with a batch size of 2. The subsequent phase involves training the denoise diffusion U-net model, which takes around 360 hours using 4× NVIDIA A100 SXM GPUs with a batch size of 64. In this implementation, the input image size is 256×256 . The diffusion process uses T=1000 in training, and the loss function is l2 -based with an objective of predicting KC. The start distribution is set to normal, and the perceptual weight is set to 0. Although a larger batch size can achieve better training results and higher training speed [26], the batch size in the first stage is significantly smaller than that in the second stage. In the first stage, both the input and output are raw image data, which consumes substantial video memory. In contrast, during the second stage, when training the diffusion model, the data is processed in the latent space encoded by the VAE, thereby reducing video memory consumption. Consequently, a larger batch size can be employed to enhance training speed and accuracy. This highlights the importance of using the VAE to encode data into the latent space. The hyper-parameter for the diffusion timesteps T is set to 500 for inference, and the diffusion process is decoupled with ft defined as −z0 .

D. Comparisons With SOTA Methods
To evaluate the proposed RadioDiff model, we compare it with other SOTA methods. To ensure a comprehensive comparison of the experiments, we compare the CNN-based, GAN-based, and Mamba-based methods separately, which represent the primary architectures used in the current RM reconstruction task based on deep learning.

For the detailed parameter settings of the comparison model, we adhere to the description provided in the article [18], [21], [38]. Additionally, for fairness, the training and test data will be aligned with RadioDiff.

The following method is used to compare.

RadioUNet [18]: RadioUNet is one of the most effective sampling-free NN-based RM construction method, where a convolutional U-Net is used as the backbone NN, and the supervised learning is used to train the RadioUNet. RadioUNet reconstructs the wireless propagation graph using a simple yet effective network architecture that learns environmental characteristics, making it one of the most representative reconfiguration algorithms based on reel machines.

UVM-Net [38]: The training method and settings of UVM-Net are same as RadioUNet, but the backbone network is replaced by a convolutional layer with the latest SSMs (State Space Sequence Models). SSMs are specifically designed to handle long-sequence data and are particularly well-suited for modeling long-range dependencies. SSMs map the input sequence to a hidden state through a state space model and predict the output based on this hidden state. As a result, SSMs exhibit enhanced local feature capture and efficient remote modeling capabilities. We selected UVM-Net as the baseline to evaluate the performance differences between this SSM-driven architecture and traditional convolutional networks in the wireless propagation graph reconstruction task.

RME-GAN [21]: The SOTA NN-based RM construction method, which uses a generative model cGAN to construct RM. However, RME-GAN is sampling-based, it not only uses environmental features but also uses the sampling pathloss as the input to construct the RM. For a fair comparison, the RME-GAN in this paper only uses environmental features as input. As GAN models have been at the forefront of generative model research in recent years, they effectively showcase the unique capabilities and challenges of generative adversarial networks in handling RM reconstruction tasks.

1) Comparisons for SRM:
For the quantitative comparison on the RadioMapSeer-Test dataset for SRM scenarios is given in the first part of Table II and Fig. 4, our model outperforms others in error metrics, i.e., NMSE, RMSE, and structural metrics, i.e., SSIM, PSNR, indicating that our predictions and generated RM are more accurate. Notably, RadioDiff excels in the PSNR metric, indicating that the RMs it generates have clearer and sharper structural edges compared to other methods. Furthermore, the qualitative comparison presented in Fig. 4 demonstrates that the RMs constructed by RadioDiff closely resemble the ground truth, with well-defined edge features. This precision stems from the diffusion model’s heightened sensitivity to the high-frequency signals of edge information, while the AFTs effectively enhance and isolate these signals. In contrast, structures such as CNNs and Mamba are less responsive to edge information, as is shown in RadioUNet and UVM-Net since they show inaccuracies in radiation signal positioning and edge blurring. As for the generative model RME-GAN, which relies on adversarial strategies, it tends to yield ambiguous and less precise results since it relies on the sampling position measurements, so in the sampling-free RM construction scenario it performs poorly.

TABLE II Quantitative Comparison. Results in Bold Red and Underlined Blue Highlight the Highest and Second Highest, Respectively. The ↑ Indicates Metrics Whereby Higher Values Constitute Improved Outcomes, With Higher Values Preferred for All Other Metrics
Table II- Quantitative Comparison. Results in Bold Red and Underlined Blue Highlight the Highest and Second Highest, Respectively. The $\uparrow $
 Indicates Metrics Whereby Higher Values Constitute Improved Outcomes, With Higher Values Preferred for All Other Metrics

Fig. 4. - The comparisons of constructed SRM on different methods.

Fig. 4.
The comparisons of constructed SRM on different methods.

Show All

2) Comparisons for DRM:
As shown in the second part of Table II and Fig. 5, the quantitative comparison on the RadioMapSeer-Test dataset for DRM scenarios is given. In DRM scenarios, the models must account for additional dynamic environmental factors. Despite a general decline in performance, the second part of Table II shows that RadioDiff consistently delivers the best results across all indicators. As shown in Fig. 5, the RadioDiff model exhibits enhanced sensitivity to dynamic environmental factors such as vehicles, whereas the RME-GAN, RadioUNet, and UVM-Net models struggle with these elements, often resulting in significant blurring and distortion. This further highlights that RadioDiff has stable high performance under more challenging conditions, particularly in scenarios characterized by complex environments and overlapping signals.

Fig. 5. - The comparisons of constructed DRM on different methods.

Fig. 5.
The comparisons of constructed DRM on different methods.

Show All

E. Ablation Study
In this section, we analyze the impact of the AFT on the performance of the RadioDiff model. The qualitative results in Fig. 6 vividly illustrate the visual disparity between radio patterns generated with and without employing the AFT. By incorporating the AFT, our model exhibits an enhanced capability to accurately detect and represent edge signals. This improvement is particularly noticeable when dealing with scenarios involving signal superposition, as evidenced by images produced by our model equipped with AFTs that possess increasingly sharper edges. Furthermore, Table III presents quantitative comparison results, demonstrating that a better performance can be achieved through the utilization of the AFT.

TABLE III Ablation Study About AFT
Table III- Ablation Study About AFT

Fig. 6. - Ablation study about AFT. The qualitative results demonstrate that incorporating the AFT further enhances the model’s sensitivity to edge signals. This leads to RM images with more accurate edges and more robust results when multiple signals overlap.

Fig. 6.
Ablation study about AFT. The qualitative results demonstrate that incorporating the AFT further enhances the model’s sensitivity to edge signals. This leads to RM images with more accurate edges and more robust results when multiple signals overlap.

Show All

F. Limitations and Discussion
Although this paper proposes a pioneer exploration of utilizing diffusion models for RM construction, and the proposed RadioDiff achieves SOTA performance, the issue of efficiency remains a key consideration for such a large generative model-based method. Table IV presents a comparison of the inference time and memory usage between the RadioDiff model and alternative models, showing that the diffusion model requires more resources and has a longer inference time than other methods. However, it should be emphasized that although the proposed RadioDiff is more time-consuming than other NN-based methods, the inference delay is still less than one second, which remains acceptable for dynamically constructing RM. For training data, RadioDiff uses the same dataset as other NN-based methods, and no limitations regarding its access to training data were identified in the experiment. In addition, although VAE needs to be trained separately before RadioDiff’s formal training, this is due to LDM being used for the RM reconstruction task for the first time. In subsequent research, the relevant pre-trained weights of VAE can be directly used without re-training, which will significantly streamline future research efforts. Moreover, techniques such as NN compression and efficient inference methods like denoising diffusion implicit models (DDIM) [39] can be leveraged to notably enhance efficiency, raising a trade-off between performance and efficiency, which stands as a promising direction for future research.

TABLE IV Inference Time and Memory Consuming. Results in Bold Red and Underlined Blue Highlight the Highest and Second Highest, Respectively
Table IV- Inference Time and Memory Consuming. Results in Bold Red and Underlined Blue Highlight the Highest and Second Highest, Respectively

Furthermore, it is noteworthy that almost all existing NN-based RM construction methods, including this paper, concentrate on predicting pathloss from a BS to a specific location, known as one-to-any (O2X) RM. However, there is also another type of RM that is any-to-any (X2X) RM scenario, which aims at obtaining pathloss between any two points through their positions. X2X RM construction poses a challenge with sampling-based approaches, as these methods typically require a fixed BS location to estimate pathloss of any other position to the fixed BS. In contrast, by adopting a sampling-free RM construction approach in this paper and incorporating the location of BS as input for the diffusion model as part of the prompt, it is feasible to predict pathloss between any two points by adjusting the prompt of the BS position, thereby enabling the construction of X2X RM.

SECTION VI.Conclusion
In this paper, we have proposed RadioDiff, a diffusion-based RM generative model to effectively construct the RM. By incorporating various techniques, including AFTs and the decoupled diffusion model, RadioDiff can construct accurate and sharp RM effectively. Extensive experiments demonstrate the qualitative and quantitative superiority of the proposed RadioDiff. As the first application of diffusion models to RM construction tasks, RadioDiff sets a new benchmark for future technological advancements. In future work, we will focus on how to leverage the diffusion model to generate the environment features based on the sparse RM information.
