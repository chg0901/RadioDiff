flowchart TD
    A["Start"] --> B["Sample t"]
    B --> C["Gen Noise"]
    C --> D["Target C = -x₀"]
    D --> E["x_noisy = x₀ + C*t + √t*noise"]
    E --> F["UNet Forward"]
    F --> G["Get C_pred, noise_pred"]
    G --> H["Compute Losses"]
    H --> I["Apply Weights"]
    I --> J["Total Loss"]
    
    style A fill:#e1f5fe
    style J fill:#c8e6c9
    style H fill:#fff3e0
    style I fill:#f3e5f5