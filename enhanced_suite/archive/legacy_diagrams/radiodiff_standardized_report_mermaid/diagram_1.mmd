graph TB
    subgraph "ðŸ“¡ Input Data Pipeline"
        A[RadioMapSeer Dataset<br/>320Ã—320 Radio Maps] --> B[RadioUNet_c Loader<br/>batch_size: 66]
        B --> C[Gradient Accumulation<br/>8 steps â†’ Effective: 528]
        C --> D[Input Tensors<br/>image: BÃ—1Ã—320Ã—320<br/>cond: BÃ—3Ã—320Ã—320]
    end
    
    subgraph "ðŸŽ¯ First Stage: VAE Encoder"
        E[AutoencoderKL<br/>embed_dim: 3] --> F[Encoder<br/>ResNet Architecture]
        F --> G[Latent Space z<br/>z~q_Ï†(z|x)<br/>Shape: [B, 3, 80, 80]]
        G --> H[16Ã— Compression<br/>320Ã—320 â†’ 80Ã—80<br/>Computational Efficiency]
    end
    
    subgraph "ðŸ”„ Second Stage: Conditional U-Net"
        I[Conditional U-Net<br/>dim: 128] --> J[Time Embedding<br/>Sinusoidal Encoding]
        J --> K[Condition Integration<br/>Swin Transformer<br/>Window-based Attention]
        K --> L[Multi-scale Features<br/>dim_mults: [1,2,4,4]]
        L --> M[Adaptive FFT Module<br/>Frequency Domain Enhancement]
        M --> N[Noise Prediction<br/>Îµ_Î¸(x_t, t, c)]
    end
    
    subgraph "ðŸŒŠ Diffusion Process"
        O[Forward Diffusion<br/>q(x_t|x_0) = ð’©(âˆšÎ±Ì„_tx_0, (1-Î±Ì„_t)ðˆ)] --> P[Noise Schedule<br/>Î²_t: linear 0.0001â†’0.02]
        P --> Q[Reverse Process<br/>p_Î¸(x_0|x_t, c)]
        Q --> R[Knowledge-Aware Objective<br/>pred_KC]
    end
    
    subgraph "âš™ï¸ Training Loop"
        S[L2 Loss Computation] --> T[Backpropagation<br/>Gradient Clipping: 1.0]
        T --> U[AdamW Optimizer<br/>lr: 5e-5, wd: 1e-4]
        U --> V[Cosine LR Schedule<br/>lr(t) = max(5e-6, 5e-5Ã—(1-t/T)^0.96)]
        V --> W[EMA Model Update<br/>Î²: 0.999<br/>after 10,000 steps]
    end
    
    D --> E
    G --> I
    N --> S
    R --> S
    
    style A fill:#E3F2FD
    style E fill:#F3E5F5
    style I fill:#E8F5E8
    style O fill:#FFF3E0
    style S fill:#FCE4EC