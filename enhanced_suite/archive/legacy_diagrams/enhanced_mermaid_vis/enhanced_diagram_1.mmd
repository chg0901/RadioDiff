%%{
  init: {
    'theme': 'default',
    'themeVariables': {
      'primaryColor': '#ff6b6b',
      'primaryTextColor': '#2c3e50',
      'primaryBorderColor': '#3498db',
      'lineColor': '#34495e',
      'secondaryColor': '#f8f9fa',
      'tertiaryColor': '#e9ecef',
      'clusterBkg': '#ffffff',
      'clusterBorder': '#dee2e6',
      'fontSize': '18px',
      'fontFamily': 'Arial, sans-serif'
    }
  }
}%%

graph LR
    A[Input<br/>320×320×1] --> B[VAE Encoder]
    B --> C[Latent Space<br/>3D Gaussian]
    C --> D[VAE Decoder]
    D --> E[Reconstruction<br/>320×320×1]
    
    F[Ground Truth] --> G[Reconstruction Loss]
    E --> G
    
    C --> H[KL Divergence<br/>Latent Regularization]
    
    E --> I[Discriminator]
    F --> I
    I --> J[Adversarial Loss]
    
    G --> K[Total Loss<br/>L_total = L_rec + L_kl + L_adv]
    H --> K
    J --> K
    
    style A fill:#e1f5fe,stroke:#01579b,stroke-width:3px,font-weight:bold
    style F fill:#e1f5fe,stroke:#01579b,stroke-width:3px,font-weight:bold
    style K fill:#ffecb3,stroke:#ff6f00,stroke-width:3px,font-weight:bold
    style C fill:#f3e5f5,stroke:#4a148c,stroke-width:3px,font-weight:bold