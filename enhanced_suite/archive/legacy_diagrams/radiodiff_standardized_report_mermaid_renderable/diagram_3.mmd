flowchart TD
    subgraph "Data Loading"
        A[RadioMapSeer Dataset] --> B[RadioUNet_c Loader]
        B --> C[Batch Creation]
        C --> D[Data Augmentation]
    end
    
    subgraph "Input Processing"
        E[Image] --> F[Normalization]
        G[Condition] --> H[Multi-channel Encoding]
        I[Mask] --> J[Binary Processing]
    end
    
    subgraph "Batch Structure"
        K[Batch Dictionary] --> L[image: Pathloss]
        K --> M[cond: Building Layout]
        K --> N[ori_mask: Spatial Mask]
        K --> O[img_name: Metadata]
    end
    
    subgraph "Forward Pass"
        P[VAE Encoder] --> Q[Latent Representation]
        Q --> R[Conditional U-Net]
        R --> S[Loss Computation]
    end
    
    A --> B
    D --> E
    D --> G
    D --> I
    F --> L
    H --> M
    J --> N
    L --> K
    M --> K
    N --> K
    K --> P
    Q --> R