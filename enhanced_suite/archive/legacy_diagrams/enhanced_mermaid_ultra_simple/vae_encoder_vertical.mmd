%% Vertical Multi-Column VAE Encoder Architecture - 16:9 Layout
graph TB
    subgraph "📡 INPUT COLUMN"
        A1["🎯 Input Data<br/>320×320×1<br/>Radio map"]
        A2["📊 Shape<br/>B×1×320×320"]
        A3["🔧 Type<br/>Float32"]
        
        A1 --> A2
        A2 --> A3
    end
    
    subgraph "🔄 ENCODING COLUMN"
        B1["🔧 Conv 128<br/>Feature extraction<br/>Kernel: 3×3"]
        B2["📐 ResNet 1<br/>320→160<br/>Downsample 2×"]
        B3["📐 ResNet 2<br/>160→80<br/>Downsample 2×"]
        B4["🎯 Bottleneck<br/>80×80×3<br/>Latent space"]
        
        B1 --> B2
        B2 --> B3
        B3 --> B4
    end
    
    subgraph "📊 MATHEMATICAL COLUMN"
        C1["📊 Mean μ<br/>Distribution<br/>z ~ N(μ, σ²)"]
        C2["📊 Variance σ²<br/>Uncertainty<br/>log σ²"]
        C3["🔄 Reparameterization<br/>z = μ + σ·ε"]
        C4["📈 Latent Distribution<br/>q_φ(z|x)"]
        
        C1 --> C2
        C2 --> C3
        C3 --> C4
    end
    
    subgraph "⚡ FEATURES COLUMN"
        D1["⚡ Multi-scale<br/>320→160→80<br/>Hierarchical"]
        D2["🎯 16× Compression<br/>Efficient<br/>Computational"]
        D3["🔒 Information Bottleneck<br/>Essential features<br/>Only key info"]
        D4["📈 Benefits<br/>Memory efficiency<br/>Faster training"]
        
        D1 --> D2
        D2 --> D3
        D3 --> D4
    end
    
    %% Column connections
    A3 --> B1
    B4 --> C1
    C4 --> D1
    
    %% Style columns with different colors
    style A1 fill:#F3E5F5,stroke:#7B1FA2,stroke-width:2px
    style B1 fill:#E3F2FD,stroke:#1976D2,stroke-width:2px
    style C1 fill:#E8F5E8,stroke:#388E3C,stroke-width:2px
    style D1 fill:#FFF3E0,stroke:#F57C00,stroke-width:2px