%% Enhanced Diffusion Process - Clean
%%{init: {'theme': 'base', 'themeVariables': { 'primaryColor': '#f57c00', 'primaryTextColor': '#ffffff', 'primaryBorderColor': '#e65100', 'lineColor': '#757575', 'secondaryColor': '#7b1fa2', 'tertiaryColor': '#1976d2', 'background': '#f5f5f5'}}}%%
graph TB
    subgraph "ðŸ“ˆ FORWARD DIFFUSION PROCESS"
        A[<b>Clean Data x_0</b><br/>Radio map<br/>Original distribution] --> B[<b>Noise Schedule</b><br/>beta_t: linear 0.0001â†’0.02<br/>1000 timesteps]
        B --> C[<b>Noise Addition</b><br/>Gaussian noise<br/>epsilon ~ N(0, I)]
        C --> D[<b>Noisy Data x_t</b><br/>Forward process<br/>x_t = sqrt(alpha_bar_t)x_0 + sqrt(1-alpha_bar_t)epsilon]
        D --> E[<b>Forward Distribution</b><br/>Conditional Gaussian<br/>q(x_t|x_0)]
    end
    
    subgraph "ðŸ”„ REVERSE DIFFUSION PROCESS"
        F[<b>Noisy Input x_t</b><br/>Iterative denoising<br/>t = T, T-1, ..., 1] --> G[<b>Condition Integration</b><br/>Building layout<br/>Spatial conditioning]
        G --> H[<b>U-Net Prediction</b><br/>Noise estimation<br/>epsilon_theta(x_t, t, c)]
        H --> I[<b>Denoising Step</b><br/>Reverse process<br/>x_{t-1} = (x_t - epsilon_theta)/sqrt(alpha_t) + sigma_t z]
        I --> J[<b>Reverse Distribution</b><br/>Learned reverse<br/>p_theta(x_{t-1}|x_t, c)]
    end
    
    subgraph "ðŸŽ¯ KNOWLEDGE-AWARE OBJECTIVE"
        K[<b>Training Objective</b><br/>pred_KC<br/>Radio propagation physics] --> L[<b>Loss Function</b><br/>Mean squared error<br/>L_KC = E||epsilon - epsilon_theta||^2]
        L --> M[<b>Optimization Target</b><br/>Parameter learning<br/>min_theta L_KC]
        M --> N[<b>Physics Integration</b><br/>Electromagnetic constraints<br/>Domain knowledge]
    end
    
    subgraph "âš¡ SAMPLING EFFICIENCY"
        O[<b>Traditional Diffusion</b><br/>1000 steps<br/>Slow inference] --> P[<b>RadioDiff Innovation</b><br/>Single-step sampling<br/>Real-time generation]
        P --> Q[<b>Computational Benefit</b><br/>1000x speedup<br/>Practical deployment]
        Q --> R[<b>Sampling-Free</b><br/>No field measurements<br/>Cost-effective]
    end
    
    E --> F
    J --> K
    N --> O
    
    style A fill:#FFF3E0,stroke:#F57C00,stroke-width:3px,color:#000000
    style F fill:#F3E5F5,stroke:#7B1FA2,stroke-width:3px,color:#000000
    style K fill:#E3F2FD,stroke:#1976D2,stroke-width:3px,color:#000000
    style O fill:#FFEBEE,stroke:#D32F2F,stroke-width:3px,color:#000000